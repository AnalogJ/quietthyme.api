{
  "S3Bucket${self:service}-${opt:stage, self:provider.stage}-content": {
    "Type" : "AWS::S3::Bucket",
    "Properties": {
      "BucketName" : "${self:service}-${opt:stage, self:provider.stage}-content"
    }
  },
  "QuietThymeContentBucketPolicy" : {
    "Type" : "AWS::S3::BucketPolicy",
    "Properties" : {
      "PolicyDocument": {
        "Id"           : "Grant read-only access to public users",
        "Statement":[
          {
            "Sid":"PublicReadPerms",
            "Effect":"Allow",
            "Principal": "*",
            "Action":["s3:GetObject"],
            "Resource":{ "Fn::Join" : ["", ["arn:aws:s3:::", {"Ref" : "S3Bucket${self:service}-${opt:stage, self:provider.stage}-content"}, "/*" ]]}
          }
        ]
      },
      "Bucket" : {"Ref" : "S3Bucket${self:service}-${opt:stage, self:provider.stage}-content"}
    }
  },

  "S3Bucket${self:service}-${opt:stage, self:provider.stage}-upload": {
    "Type" : "AWS::S3::Bucket",
    "Properties": {
      "BucketName" : "${self:service}-${opt:stage, self:provider.stage}-upload"
    }
  },
  "QuietThymeUploadBucketPolicy" : {
    "Type" : "AWS::S3::BucketPolicy",
    "Properties" : {
      "PolicyDocument": {
        "Id"           : "Grant access readonly access to public users",
        "Statement":[
          {
            "Sid":"PublicReadPerms",
            "Effect":"Allow",
            "Principal": "*",
            "Action":["s3:GetObject"],
            "Resource":{ "Fn::Join" : ["", ["arn:aws:s3:::", {"Ref" : "S3Bucket${self:service}-${opt:stage, self:provider.stage}-upload"}, "/*" ]]}
          }
        ]
      },
      "Bucket" : {"Ref" : "S3Bucket${self:service}-${opt:stage, self:provider.stage}-upload"}
    }
  }
}